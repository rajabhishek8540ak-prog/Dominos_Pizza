-- Total Revenue:- The sum of the total price of all pizza orders
SELECT  
    ROUND(SUM(quantity * unit_price), 0) AS Total_Revenue
FROM PIZZA_SALES;
         -- OR
    SELECT 
    ROUND(SUM(total_price), 0) AS Total_Revenue
FROM PIZZA_SALES;

-- Average Order Value:- This metric represents the average amount spent per order, 
-- calculated by dividing the total revenue by the total number of orders.
SELECT 
    SUM(total_price) / COUNT(DISTINCT order_id) AS Avg_Order_value
FROM PIZZA_SALES;

-- Total pizza sold:- The sum of quantities of total pizza sold
SELECT 
    SUM(quantity) AS Totoal_Pizza_Sold
FROM PIZZA_SALES;
    
-- Total order:- total number of orders placed
 SELECT 
    COUNT(DISTINCT order_id) AS Total_Order
FROM PIZZA_SALES;   
    
-- Average Pizzas per Order:- This metric represents the average number of pizzas sold per order, 
-- calculated by dividing the total number of pizzas sold by the total number of orders.
SELECT 
    SUM(quantity) / COUNT(DISTINCT order_id) AS Avg_Pizza_Order
FROM PIZZA_SALES;
    
-- Daily Trend for Total Orders:- This analysis shows the day-wise total orders for each day of the week, 
-- helping to identify which days experience higher or lower order activity.
SELECT 
    DAYNAME(STR_TO_DATE(ORDER_DATE, '%m/%d/%Y')) AS ORDER_DAY,
    COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDERS
FROM PIZZA_SALES
GROUP BY ORDER_DAY
ORDER BY TOTAL_ORDERS DESC;

-- Hourly Trend for Total Orders:- This analysis shows the hour-wise trend of total orders throughout the day, 
-- helping to identify peak hours and periods of high order activity.
SELECT 
    HOUR(order_time) AS Order_Time,
    COUNT(DISTINCT order_id) AS Total_Order
FROM PIZZA_SALES
GROUP BY HOUR(order_time)
ORDER BY Total_Order DESC;

-- Monthly Trend for Total Orders:- This analysis shows the month-wise trend of total orders, 
-- helping to identify peak months and periods of high order activity
SELECT 
    MONTHNAME(STR_TO_DATE(ORDER_DATE, '%m/%d/%Y')) AS Months,
    COUNT(DISTINCT order_id) AS Total_Order
FROM PIZZA_SALES
GROUP BY MONTHNAME(STR_TO_DATE(ORDER_DATE, '%m/%d/%Y'))
ORDER BY Total_Order DESC;

-- Percentage of Sales by Pizza Category:- This analysis shows the distribution of sales across different pizza categories, 
-- providing insights into the popularity of each category and its contribution to overall revenue.
SELECT 
    pizza_category,
    SUM(total_price) AS Revenue,
    SUM(total_price) * 100 / (SELECT 
            SUM(total_price)
        FROM PIZZA_SALES) AS Percentage_contribution
FROM PIZZA_SALES
GROUP BY pizza_category;

 -- For any Specific month like January Percentage of Sales by Pizza Category
 SELECT 
    pizza_category,
    SUM(total_price) AS Revenue,
    ROUND(SUM(total_price) * 100 / (SELECT 
		SUM(total_price)
		FROM PIZZA_SALES WHERE order_date = 1), 2) AS Percentage_Contribution
FROM PIZZA_SALES 
WHERE order_date = 1
GROUP BY pizza_category;
     -- OR
SELECT 
    pizza_category,
    SUM(total_price) AS Revenue,
    ROUND(SUM(total_price) * 100 / (SELECT 
		SUM(total_price)
		FROM PIZZA_SALES WHERE MONTH(STR_TO_DATE(order_date, '%m/%d/%Y')) = 1), 2) 
        AS Percentage_Contribution
FROM PIZZA_SALES
WHERE MONTH(STR_TO_DATE(order_date, '%m/%d/%Y')) = 1
GROUP BY pizza_category;

-- Monthly wise revenue share & persentage
SELECT 
    MONTHNAME(STR_TO_DATE(order_date, '%m/%d/%Y')) AS Month,
    ROUND(SUM(total_price), 2) AS Revenue,
    ROUND(SUM(total_price) * 100 / (SELECT 
			SUM(total_price)
			FROM PIZZA_SALES), 2) AS Percentage_Contribution
FROM PIZZA_SALES
GROUP BY Month order by Percentage_Contribution desc; 

-- Percentage of Sales by Pizza Size
SELECT 
    pizza_size,
    SUM(total_price) AS Revenue,
    ROUND(SUM(total_price)*100 / (SELECT 
	          SUM(total_price)
			FROM PIZZA_SALES), 2) AS Per_Sales
FROM PIZZA_SALES
GROUP BY pizza_size
ORDER BY Revenue DESC;

-- Top 5 best seller Pizza by Revenue, Total Quantity and Total Order
SELECT 
    pizza_name,
    SUM(total_price) AS Revenue,
    SUM(quantity) AS T_Quantity,
    COUNT(DISTINCT order_id) AS T_Order
FROM PIZZA_SALES
GROUP BY pizza_name
ORDER BY Revenue DESC LIMIT 5;

